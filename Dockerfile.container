FROM alpine AS tools_builder
RUN apk add --no-cache busybox && /bin/busybox --install -s /bin

FROM scratch

ARG TARGETOS
ARG TARGETARCH

COPY --from=tools_builder /bin/busybox /busybox
RUN ["/busybox", "sh", "-c", "/busybox --install -s /bin && mkdir -p /binaries"]

WORKDIR /

COPY bin/*$TARGETOS-$TARGETARCH /binaries/

CMD ["/bin/ls", "-lrt", "/binaries/"]